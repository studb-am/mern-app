"use strict";(self.webpackChunkmern_app=self.webpackChunkmern_app||[]).push([[122],{8159:function(e,n,t){t.d(n,{$:function(){return v},i:function(){return g}});var r,i=t(1413),a=t(885),o=t(5861),l=t(7757),c=t.n(l),u=t(2791),s=function(){return r.current},d=function(){r=(0,u.useRef)([])},p=function(){return r.current=[]},f=function(e){r.current=r.current.filter((function(n){return n!==e}))},h=function(){var e=(0,o.Z)(c().mark((function e(n){var t,i,a,o,l,u,s,d,p,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.setLoading,i=n.setError,a=n.url,o=n.method,l=n.headers,u=n.body,e.prev=1,t(!0),s=new AbortController,c=s,r.current.push(c),e.next=7,fetch(a,{method:o,headers:l,body:u});case 7:return d=e.sent,e.next=10,d.json();case 10:if(p=e.sent,d.ok){e.next=15;break}throw h=new Error(p.message||"An unexpected error occured. Please try again later!"),i(h),h;case 15:return f(s),e.abrupt("return",p);case 19:throw e.prev=19,e.t0=e.catch(1),i(e.t0),e.t0;case 23:return e.prev=23,t(!1),e.finish(23);case 26:case"end":return e.stop()}var c}),e,null,[[1,19,23,26]])})));return function(n){return e.apply(this,arguments)}}(),v=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=(0,u.useState)(!1),o=(0,a.Z)(i,2),l=o[0],c=o[1],f=(0,u.useState)(null),v=(0,a.Z)(f,2),g=v[0],m=v[1],x=(0,u.useState)(null),Z=(0,a.Z)(x,2),C=Z[0],j=Z[1];d();var y=function(){m(null)},w=(0,u.useCallback)((function(){return h({setLoading:c,setError:m,url:e,method:t,headers:r,body:n})}),[]);return(0,u.useEffect)((function(){w().then((function(e){return j(e)}))}),[w]),(0,u.useEffect)((function(){return function(){s().forEach((function(e){return e.abort()})),p()}}),[]),{data:C,loading:l,error:g,clearError:y}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{"Content-Type":"application/json"},n=(0,u.useState)(!1),t=(0,a.Z)(n,2),r=t[0],o=t[1],l=(0,u.useState)(null),c=(0,a.Z)(l,2),f=c[0],v=c[1];d();var g=function(){v(null)},m=(0,u.useCallback)((function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST";return h((0,i.Z)({setLoading:o,setError:v,method:t,headers:e},n))}),[]);return(0,u.useEffect)((function(){return function(){s().forEach((function(e){return e.abort()})),p()}}),[]),[m,{loading:r,error:f,clearError:g}]}},588:function(e,n,t){t.d(n,{hg:function(){return c},CP:function(){return u},Ox:function(){return s},Gu:function(){return d}});var r=t(7762),i="REQUIRE",a="MINLENGTH",o="MAXLENGTH",l="EMAIL",c=function(){return{type:i}},u=function(e){return{type:a,val:e}},s=function(){return{type:l}},d=function(e,n){var t,c=!0,u=(0,r.Z)(n);try{for(u.s();!(t=u.n()).done;){var s=t.value;s.type===i&&(c=c&&e.trim().length>0),s.type===a&&(c=c&&e.trim().length>=s.val),s.type===o&&(c=c&&e.trim().length<=s.val),"MIN"===s.type&&(c=c&&+e>=s.val),"MAX"===s.type&&(c=c&&+e<=s.val),s.type===l&&(c=c&&/^\S+@\S+\.\S+$/.test(e))}}catch(d){u.e(d)}finally{u.f()}return c}},8449:function(e,n,t){t(2791);var r=t(9658),i=t(7317),a=t(184);n.Z=function(e){var n=e.error,t=e.onClose;return(0,a.jsxs)(r.Z,{severity:"error",onClose:t,children:[(0,a.jsx)(i.Z,{children:"Error"}),n.message]})}},5212:function(e,n,t){t.d(n,{Z:function(){return b}});var r=t(885),i=t(4942),a=t(1413),o=t(2791),l=t(890),c=t(4554),u=t(6303),s=t(3767),d=t(6151),p=t(6871),f=t(588),h=t(3198),v=t(9504),g=t(5789),m=t(743),x=(t(4984),t(184)),Z=function(e){var n=e.open,t=e.onClose,i=e.title,a=e.onLocationChange,l=(0,o.useState)(null),u=(0,r.Z)(l,2),s=u[0],p=u[1];return(0,x.jsx)(h.Z,{open:n,onClose:t,children:(0,x.jsxs)(g.r,{children:[(0,x.jsx)(g.R,{title:i}),(0,x.jsxs)(v.Z,{sx:{height:"95%"},children:[(0,x.jsx)(m.D5,{centerCoords:{lat:44.8336,lng:7.761},initialZoom:14,mapStyle:"https://locomovolt.com:8080/styles/basic-preview/style.json",mapClassName:"map",mapContainerClassName:"map-wrap",minZoom:9,maxZoom:18,navigationControl:"top-right",onClick:function(e){p(e.lngLat)},children:s&&(0,x.jsx)(m.Jx,{coords:{lat:s.lat,lng:s.lng},options:{color:"#3FB1CE",draggable:!1}})}),(0,x.jsxs)(c.Z,{padding:3,textAlign:"center",children:[(0,x.jsx)(d.Z,{variant:"contained",disabled:!s,onClick:function(){a(s),t()},children:"Save"}),(0,x.jsx)(d.Z,{variant:"outlined",onClick:t,children:"Cancel"})]})]})]})})},C=t(8449),j=t(1462),y=t(1995),w=t(8159),E=function(e,n){var t;if("ON_CHANGE"===n.type){var r=!0,o=!1;for(var l in"location"===n.inputId?n.val&&n.val.lat&&n.val.lng&&(o=!0):o=!("imageUrl"!==n.inputId||!n.val)||(0,f.Gu)(n.val,n.validators),e)"meta"!==l&&(r=l===n.inputId?r&&o:r&&e[l].isValid);return(0,a.Z)((0,a.Z)({},e),{},(t={},(0,i.Z)(t,n.inputId,{value:n.val,hasBeenFocued:!0,isValid:o}),(0,i.Z)(t,"meta",(0,a.Z)((0,a.Z)({},e.meta),{},{isValid:r})),t))}return e},b=function(e){var n=e.initialState,t=e.action,i=(0,o.useReducer)(E,n),a=(0,r.Z)(i,2),h=a[0],v=a[1],g=(0,o.useContext)(j.V),m=(0,o.useState)(!1),b=(0,r.Z)(m,2),I=b[0],S=b[1],k=(0,w.i)(),N=(0,r.Z)(k,2),A=N[0],L=N[1],T=L.error,V=L.clearError,P=(0,p.s0)();return(0,x.jsxs)("div",{className:"formContainer",children:[T&&(0,x.jsx)(C.Z,{error:T,onClose:V}),(0,x.jsx)(l.Z,{variant:"h6",sx:{padding:3},children:"new-place"===t?"Insert information to add a new place":"Edit information of the existing place"}),(0,x.jsxs)(c.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"80%",marginLeft:"10%",height:"5%"}},noValidate:!0,autoComplete:"off",children:[(0,x.jsx)(u.Z,{id:"title",label:"Title",fullWidth:!0,error:!h.title.isValid&&h.title.hasBeenFocused,helperText:!h.title.isValid&&h.title.hasBeenFocued&&"Title must not be empty!",value:h.title.value,onChange:function(e){return v({type:"ON_CHANGE",val:e.target.value,inputId:"title",validators:[(0,f.hg)()]})}}),(0,x.jsx)(u.Z,{id:"description",label:"Description",multiline:!0,rows:4,fullWidth:!0,error:!h.description.isValid&&h.description.hasBeenFocused,helperText:!h.description.isValid&&h.description.hasBeenFocued&&"Please provide a description with at least 5 characters!",value:h.description.value,onChange:function(e){return v({type:"ON_CHANGE",val:e.target.value,inputId:"description",validators:[(0,f.CP)(5)]})}}),"new-place"===t&&(0,x.jsx)(s.Z,{direction:"column",sx:{m:1,justifyContent:"center",alignItems:"center",width:"100%"},children:(0,x.jsx)(y.Z,{id:"image",center:!0,onInputLoad:function(e){console.log(e),v({type:"ON_CHANGE",inputId:"imageUrl",val:e,validators:[]})}})}),"new-place"===t&&(0,x.jsxs)(s.Z,{direction:"row",spacing:10,sx:{marginTop:"2%",alignItems:"center",marginLeft:"10%"},children:[(0,x.jsx)(d.Z,{variant:"text",onClick:function(){return S(!0)},children:"Pick up the location"}),h.location.value&&(0,x.jsxs)("p",{children:["LATITUDE: ",h.location.value.lat,"; LONGITUDE: ",h.location.value.lng," "]})]}),(0,x.jsx)(d.Z,{variant:"contained",disabled:!h.meta.isValid,sx:{marginLeft:"41%",marginRight:"30%",marginTop:"3%"},onClick:function(e){e.preventDefault();var n=new FormData;"new-place"===t?(n.append("title",h.title.value),n.append("description",h.description.value),n.append("imageUrl",h.imageUrl.value),n.append("coordinates",JSON.stringify(h.location.value)),n.append("creator",g.userId),A({url:"http://locomovolt.com:4000/api/places",body:n,headers:{Authorization:"Bearer ".concat(g.token)}}).then((function(e){console.log("Data successfully inserted"),P("/")}))):A({url:"http://locomovolt.com:4000/api/places/place/".concat(h.meta.placeId),body:JSON.stringify({title:h.title.value,description:h.description.value}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(g.token)}},"PATCH").then((function(e){console.log("Successfully updated!"),P("/places/user/".concat(g.userId))}))},children:"new-place"===t?"Add new place":"Save changes"})]}),(0,x.jsx)(Z,{open:I,onClose:function(){return S(!1)},title:h.title.value,onLocationChange:function(e){v({type:"ON_CHANGE",val:e,inputId:"location",validators:[]})}})]})}},1995:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(885),i=t(2791),a=t(6151),o=t(184),l=function(e){var n=e.id,t=e.onInputLoad,l=(0,i.useState)(),c=(0,r.Z)(l,2),u=c[0],s=c[1],d=(0,i.useState)(),p=(0,r.Z)(d,2),f=p[0],h=p[1],v=(0,i.useRef)();(0,i.useEffect)((function(){if(u){var e=new FileReader;e.onload=function(){h(e.result)},e.readAsDataURL(u)}}),[u]);return(0,o.jsxs)("div",{children:[(0,o.jsx)("input",{id:n,ref:v,style:{display:"none"},type:"file",accept:".jpg,.png,.jpeg",onChange:function(e){var n;e.target.files&&1===e.target.files.length&&(n=e.target.files[0],s(n)),t(n)}}),(0,o.jsxs)("div",{className:"image-upload ".concat(e.center&&"center"),children:[(0,o.jsxs)("div",{className:"image-upload__preview",children:[f&&(0,o.jsx)("img",{src:f,alt:"Preview"}),!f&&(0,o.jsx)("p",{children:"Please pick an image."})]}),(0,o.jsx)(a.Z,{variant:"outlined",onClick:function(){v.current.click()},children:"Pick Image"})]})]})}},5789:function(e,n,t){t.d(n,{r:function(){return s},R:function(){return d}});var r,i,a=t(168),o=t(7630),l=t(7621),c=t(9585),u=t(2757),s=(0,o.ZP)(l.Z)(r||(r=(0,a.Z)(["\n    width: 90%;\n    height: 60%;\n    margin-left: 5%;\n    margin-top: 15%;\n    box-shadow: 24;\n"]))),d=(0,o.ZP)(c.Z)(i||(i=(0,a.Z)(["\n    background-color: ",";\n    color: ",";\n    height: 5%;\n"])),u.rS.palette.primary.main,u.rS.palette.neutral.main)},4122:function(e,n,t){t.r(n);t(2791);var r=t(5212),i=t(184),a={title:{value:"",hasBeenFocused:!1,isValid:!1},description:{value:"",hasBeenFocused:!1,isValid:!1},location:{value:null,isValid:!1},imageUrl:{value:null,isValid:!1},meta:{isValid:!1}};n.default=function(e){return(0,i.jsx)(r.Z,{initialState:a,action:"new-place"})}},4984:function(){}}]);
//# sourceMappingURL=122.d8f6ce38.chunk.js.map