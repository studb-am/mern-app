"use strict";(self.webpackChunkmern_app=self.webpackChunkmern_app||[]).push([[198],{8159:function(e,n,t){t.d(n,{$:function(){return h},i:function(){return m}});var r,a=t(1413),i=t(885),o=t(5861),l=t(7757),c=t.n(l),s=t(2791),u=function(){return r.current},d=function(){r=(0,s.useRef)([])},p=function(){return r.current=[]},f=function(e){r.current=r.current.filter((function(n){return n!==e}))},v=function(){var e=(0,o.Z)(c().mark((function e(n){var t,a,i,o,l,s,u,d,p,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.setLoading,a=n.setError,i=n.url,o=n.method,l=n.headers,s=n.body,e.prev=1,t(!0),u=new AbortController,c=u,r.current.push(c),e.next=7,fetch(i,{method:o,headers:l,body:s});case 7:return d=e.sent,e.next=10,d.json();case 10:if(p=e.sent,d.ok){e.next=15;break}throw v=new Error(p.message||"An unexpected error occured. Please try again later!"),a(v),v;case 15:return f(u),e.abrupt("return",p);case 19:throw e.prev=19,e.t0=e.catch(1),a(e.t0),e.t0;case 23:return e.prev=23,t(!1),e.finish(23);case 26:case"end":return e.stop()}var c}),e,null,[[1,19,23,26]])})));return function(n){return e.apply(this,arguments)}}(),h=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(0,s.useState)(!1),o=(0,i.Z)(a,2),l=o[0],c=o[1],f=(0,s.useState)(null),h=(0,i.Z)(f,2),m=h[0],g=h[1],Z=(0,s.useState)(null),x=(0,i.Z)(Z,2),y=x[0],C=x[1];d();var k=function(){g(null)},j=(0,s.useCallback)((function(){return v({setLoading:c,setError:g,url:e,method:t,headers:r,body:n})}),[]);return(0,s.useEffect)((function(){j().then((function(e){return C(e)}))}),[j]),(0,s.useEffect)((function(){return function(){u().forEach((function(e){return e.abort()})),p()}}),[]),{data:y,loading:l,error:m,clearError:k}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{"Content-Type":"application/json"},n=(0,s.useState)(!1),t=(0,i.Z)(n,2),r=t[0],o=t[1],l=(0,s.useState)(null),c=(0,i.Z)(l,2),f=c[0],h=c[1];d();var m=function(){h(null)},g=(0,s.useCallback)((function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST";return v((0,a.Z)({setLoading:o,setError:h,method:t,headers:e},n))}),[]);return(0,s.useEffect)((function(){return function(){u().forEach((function(e){return e.abort()})),p()}}),[]),[g,{loading:r,error:f,clearError:m}]}},588:function(e,n,t){t.d(n,{hg:function(){return c},CP:function(){return s},Ox:function(){return u},Gu:function(){return d}});var r=t(7762),a="REQUIRE",i="MINLENGTH",o="MAXLENGTH",l="EMAIL",c=function(){return{type:a}},s=function(e){return{type:i,val:e}},u=function(){return{type:l}},d=function(e,n){var t,c=!0,s=(0,r.Z)(n);try{for(s.s();!(t=s.n()).done;){var u=t.value;u.type===a&&(c=c&&e.trim().length>0),u.type===i&&(c=c&&e.trim().length>=u.val),u.type===o&&(c=c&&e.trim().length<=u.val),"MIN"===u.type&&(c=c&&+e>=u.val),"MAX"===u.type&&(c=c&&+e<=u.val),u.type===l&&(c=c&&/^\S+@\S+\.\S+$/.test(e))}}catch(d){s.e(d)}finally{s.f()}return c}},8449:function(e,n,t){t(2791);var r=t(9658),a=t(7317),i=t(184);n.Z=function(e){var n=e.error,t=e.onClose;return(0,i.jsxs)(r.Z,{severity:"error",onClose:t,children:[(0,i.jsx)(a.Z,{children:"Error"}),n.message]})}},4174:function(e,n,t){t(2791);var r=t(5769),a=t(3239),i=t(184);n.Z=function(e){var n=e.loading;return(0,i.jsxs)(r.Z,{sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer+1}},open:n,children:["     ",(0,i.jsx)(a.Z,{color:"inherit"})]})}},5212:function(e,n,t){t.d(n,{Z:function(){return w}});var r=t(885),a=t(4942),i=t(1413),o=t(2791),l=t(890),c=t(4554),s=t(6303),u=t(3767),d=t(6151),p=t(6871),f=t(588),v=t(3198),h=t(9504),m=t(5789),g=t(743),Z=(t(4984),t(184)),x=function(e){var n=e.open,t=e.onClose,a=e.title,i=e.onLocationChange,l=(0,o.useState)(null),s=(0,r.Z)(l,2),u=s[0],p=s[1];return(0,Z.jsx)(v.Z,{open:n,onClose:t,children:(0,Z.jsxs)(m.r,{children:[(0,Z.jsx)(m.R,{title:a}),(0,Z.jsxs)(h.Z,{sx:{height:"95%"},children:[(0,Z.jsx)(g.D5,{centerCoords:{lat:44.8336,lng:7.761},initialZoom:14,mapStyle:"https://locomovolt.com:8080/styles/basic-preview/style.json",mapClassName:"map",mapContainerClassName:"map-wrap",minZoom:9,maxZoom:18,navigationControl:"top-right",onClick:function(e){p(e.lngLat)},children:u&&(0,Z.jsx)(g.Jx,{coords:{lat:u.lat,lng:u.lng},options:{color:"#3FB1CE",draggable:!1}})}),(0,Z.jsxs)(c.Z,{padding:3,textAlign:"center",children:[(0,Z.jsx)(d.Z,{variant:"contained",disabled:!u,onClick:function(){i(u),t()},children:"Save"}),(0,Z.jsx)(d.Z,{variant:"outlined",onClick:t,children:"Cancel"})]})]})]})})},y=t(8449),C=t(1462),k=t(1995),j=t(8159),S=function(e,n){var t;if("ON_CHANGE"===n.type){var r=!0,o=!1;for(var l in"location"===n.inputId?n.val&&n.val.lat&&n.val.lng&&(o=!0):o=!("imageUrl"!==n.inputId||!n.val)||(0,f.Gu)(n.val,n.validators),e)"meta"!==l&&(r=l===n.inputId?r&&o:r&&e[l].isValid);return(0,i.Z)((0,i.Z)({},e),{},(t={},(0,a.Z)(t,n.inputId,{value:n.val,hasBeenFocued:!0,isValid:o}),(0,a.Z)(t,"meta",(0,i.Z)((0,i.Z)({},e.meta),{},{isValid:r})),t))}return e},w=function(e){var n=e.initialState,t=e.action,a=(0,o.useReducer)(S,n),i=(0,r.Z)(a,2),v=i[0],h=i[1],m=(0,o.useContext)(C.V),g=(0,o.useState)(!1),w=(0,r.Z)(g,2),b=w[0],E=w[1],I=(0,j.i)(),N=(0,r.Z)(I,2),P=N[0],A=N[1],L=A.error,T=A.clearError,D=(0,p.s0)();return(0,Z.jsxs)("div",{className:"formContainer",children:[L&&(0,Z.jsx)(y.Z,{error:L,onClose:T}),(0,Z.jsx)(l.Z,{variant:"h6",sx:{padding:3},children:"new-place"===t?"Insert information to add a new place":"Edit information of the existing place"}),(0,Z.jsxs)(c.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"80%",marginLeft:"10%",height:"5%"}},noValidate:!0,autoComplete:"off",children:[(0,Z.jsx)(s.Z,{id:"title",label:"Title",fullWidth:!0,error:!v.title.isValid&&v.title.hasBeenFocused,helperText:!v.title.isValid&&v.title.hasBeenFocued&&"Title must not be empty!",value:v.title.value,onChange:function(e){return h({type:"ON_CHANGE",val:e.target.value,inputId:"title",validators:[(0,f.hg)()]})}}),(0,Z.jsx)(s.Z,{id:"description",label:"Description",multiline:!0,rows:4,fullWidth:!0,error:!v.description.isValid&&v.description.hasBeenFocused,helperText:!v.description.isValid&&v.description.hasBeenFocued&&"Please provide a description with at least 5 characters!",value:v.description.value,onChange:function(e){return h({type:"ON_CHANGE",val:e.target.value,inputId:"description",validators:[(0,f.CP)(5)]})}}),"new-place"===t&&(0,Z.jsx)(u.Z,{direction:"column",sx:{m:1,justifyContent:"center",alignItems:"center",width:"100%"},children:(0,Z.jsx)(k.Z,{id:"image",center:!0,onInputLoad:function(e){console.log(e),h({type:"ON_CHANGE",inputId:"imageUrl",val:e,validators:[]})}})}),"new-place"===t&&(0,Z.jsxs)(u.Z,{direction:"row",spacing:10,sx:{marginTop:"2%",alignItems:"center",marginLeft:"10%"},children:[(0,Z.jsx)(d.Z,{variant:"text",onClick:function(){return E(!0)},children:"Pick up the location"}),v.location.value&&(0,Z.jsxs)("p",{children:["LATITUDE: ",v.location.value.lat,"; LONGITUDE: ",v.location.value.lng," "]})]}),(0,Z.jsx)(d.Z,{variant:"contained",disabled:!v.meta.isValid,sx:{marginLeft:"41%",marginRight:"30%",marginTop:"3%"},onClick:function(e){e.preventDefault();var n=new FormData;"new-place"===t?(n.append("title",v.title.value),n.append("description",v.description.value),n.append("imageUrl",v.imageUrl.value),n.append("coordinates",JSON.stringify(v.location.value)),n.append("creator",m.userId),P({url:"http://locomovolt.com:4000/api/places",body:n,headers:{Authorization:"Bearer ".concat(m.token)}}).then((function(e){console.log("Data successfully inserted"),D("/")}))):P({url:"http://locomovolt.com:4000/api/places/place/".concat(v.meta.placeId),body:JSON.stringify({title:v.title.value,description:v.description.value}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m.token)}},"PATCH").then((function(e){console.log("Successfully updated!"),D("/places/user/".concat(m.userId))}))},children:"new-place"===t?"Add new place":"Save changes"})]}),(0,Z.jsx)(x,{open:b,onClose:function(){return E(!1)},title:v.title.value,onLocationChange:function(e){h({type:"ON_CHANGE",val:e,inputId:"location",validators:[]})}})]})}},1995:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(885),a=t(2791),i=t(6151),o=t(184),l=function(e){var n=e.id,t=e.onInputLoad,l=(0,a.useState)(),c=(0,r.Z)(l,2),s=c[0],u=c[1],d=(0,a.useState)(),p=(0,r.Z)(d,2),f=p[0],v=p[1],h=(0,a.useRef)();(0,a.useEffect)((function(){if(s){var e=new FileReader;e.onload=function(){v(e.result)},e.readAsDataURL(s)}}),[s]);return(0,o.jsxs)("div",{children:[(0,o.jsx)("input",{id:n,ref:h,style:{display:"none"},type:"file",accept:".jpg,.png,.jpeg",onChange:function(e){var n;e.target.files&&1===e.target.files.length&&(n=e.target.files[0],u(n)),t(n)}}),(0,o.jsxs)("div",{className:"image-upload ".concat(e.center&&"center"),children:[(0,o.jsxs)("div",{className:"image-upload__preview",children:[f&&(0,o.jsx)("img",{src:f,alt:"Preview"}),!f&&(0,o.jsx)("p",{children:"Please pick an image."})]}),(0,o.jsx)(i.Z,{variant:"outlined",onClick:function(){h.current.click()},children:"Pick Image"})]})]})}},5789:function(e,n,t){t.d(n,{r:function(){return u},R:function(){return d}});var r,a,i=t(168),o=t(7630),l=t(7621),c=t(9585),s=t(2757),u=(0,o.ZP)(l.Z)(r||(r=(0,i.Z)(["\n    width: 90%;\n    height: 60%;\n    margin-left: 5%;\n    margin-top: 15%;\n    box-shadow: 24;\n"]))),d=(0,o.ZP)(c.Z)(a||(a=(0,i.Z)(["\n    background-color: ",";\n    color: ",";\n    height: 5%;\n"])),s.rS.palette.primary.main,s.rS.palette.neutral.main)},5198:function(e,n,t){t.r(n),t.d(n,{default:function(){return d}});var r=t(1413),a=(t(2791),t(6871)),i=t(5212),o=t(184),l=function(e){var n=e.selectedPlace,t={title:{value:n.title,hasBeenFocused:!1,isValid:!0},description:{value:n.description,hasBeenFocused:!1,isValid:!0},location:{value:n.location,isValid:!0},meta:{placeId:n.id,isValid:!0}};return(0,o.jsx)(i.Z,{initialState:t,action:"update-place"})},c=t(4174),s=t(8449),u=t(8159),d=function(e){var n=(0,a.UO)().placeId,t=(0,u.$)("http://locomovolt.com:4000/api/places/place/".concat(n)),i=t.data,d=t.error,p=t.loading,f=t.clearError;return p?(0,o.jsx)(c.Z,{loading:p}):d?(0,o.jsx)(s.Z,{error:d,onClose:f}):i&&(0,o.jsx)(l,(0,r.Z)((0,r.Z)({},e),{},{selectedPlace:i.place}))}},3239:function(e,n,t){t.d(n,{Z:function(){return A}});var r=t(168),a=t(3366),i=t(7462),o=t(2791),l=t(8182),c=t(767),s=t(2554),u=t(4036),d=t(3736),p=t(7630),f=t(5159);function v(e){return(0,f.Z)("MuiCircularProgress",e)}(0,t(208).Z)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);var h,m,g,Z,x,y,C,k,j=t(184),S=["className","color","disableShrink","size","style","thickness","value","variant"],w=44,b=(0,s.F4)(x||(x=h||(h=(0,r.Z)(["\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n"])))),E=(0,s.F4)(y||(y=m||(m=(0,r.Z)(["\n  0% {\n    stroke-dasharray: 1px, 200px;\n    stroke-dashoffset: 0;\n  }\n\n  50% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -15px;\n  }\n\n  100% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -125px;\n  }\n"])))),I=(0,p.ZP)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,n[t.variant],n["color".concat((0,u.Z)(t.color))]]}})((function(e){var n=e.ownerState,t=e.theme;return(0,i.Z)({display:"inline-block"},"determinate"===n.variant&&{transition:t.transitions.create("transform")},"inherit"!==n.color&&{color:t.palette[n.color].main})}),(function(e){return"indeterminate"===e.ownerState.variant&&(0,s.iv)(C||(C=g||(g=(0,r.Z)(["\n      animation: "," 1.4s linear infinite;\n    "]))),b)})),N=(0,p.ZP)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:function(e,n){return n.svg}})({display:"block"}),P=(0,p.ZP)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:function(e,n){var t=e.ownerState;return[n.circle,n["circle".concat((0,u.Z)(t.variant))],t.disableShrink&&n.circleDisableShrink]}})((function(e){var n=e.ownerState,t=e.theme;return(0,i.Z)({stroke:"currentColor"},"determinate"===n.variant&&{transition:t.transitions.create("stroke-dashoffset")},"indeterminate"===n.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})}),(function(e){var n=e.ownerState;return"indeterminate"===n.variant&&!n.disableShrink&&(0,s.iv)(k||(k=Z||(Z=(0,r.Z)(["\n      animation: "," 1.4s ease-in-out infinite;\n    "]))),E)})),A=o.forwardRef((function(e,n){var t=(0,d.Z)({props:e,name:"MuiCircularProgress"}),r=t.className,o=t.color,s=void 0===o?"primary":o,p=t.disableShrink,f=void 0!==p&&p,h=t.size,m=void 0===h?40:h,g=t.style,Z=t.thickness,x=void 0===Z?3.6:Z,y=t.value,C=void 0===y?0:y,k=t.variant,b=void 0===k?"indeterminate":k,E=(0,a.Z)(t,S),A=(0,i.Z)({},t,{color:s,disableShrink:f,size:m,thickness:x,value:C,variant:b}),L=function(e){var n=e.classes,t=e.variant,r=e.color,a=e.disableShrink,i={root:["root",t,"color".concat((0,u.Z)(r))],svg:["svg"],circle:["circle","circle".concat((0,u.Z)(t)),a&&"circleDisableShrink"]};return(0,c.Z)(i,v,n)}(A),T={},D={},F={};if("determinate"===b){var R=2*Math.PI*((w-x)/2);T.strokeDasharray=R.toFixed(3),F["aria-valuenow"]=Math.round(C),T.strokeDashoffset="".concat(((100-C)/100*R).toFixed(3),"px"),D.transform="rotate(-90deg)"}return(0,j.jsx)(I,(0,i.Z)({className:(0,l.Z)(L.root,r),style:(0,i.Z)({width:m,height:m},D,g),ownerState:A,ref:n,role:"progressbar"},F,E,{children:(0,j.jsx)(N,{className:L.svg,ownerState:A,viewBox:"".concat(22," ").concat(22," ").concat(w," ").concat(w),children:(0,j.jsx)(P,{className:L.circle,style:T,ownerState:A,cx:w,cy:w,r:(w-x)/2,fill:"none",strokeWidth:x})})}))}))},4984:function(){}}]);
//# sourceMappingURL=198.53cfcb5e.chunk.js.map